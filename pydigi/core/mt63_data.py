"""
MT63 modem constants and data.

Based on MT63 code by Pawel Jalocha, SP9VRC
From fldigi source: src/mt63/symbol.dat and src/mt63/mt63intl.dat
"""

import numpy as np

# Symbol parameters
SYMBOL_LEN = 512  # FFT window and symbol shape length
SYMBOL_SEPAR = 200  # Distance in samples between symbols on a carrier
DATA_CARR_SEPAR = 4  # Carriers must be spaced by 4 FFT bins

# MT63 uses 64 data carriers
DATA_CARRIERS = 64

# Interleave pattern for short interleave (32 symbols)
SHORT_INTLV_PATT = np.array([
    4, 5, 6, 7,
    4, 5, 6, 7,
    4, 5, 6, 7,
    4, 5, 6, 7,
    4, 5, 6, 7,
    4, 5, 6, 7,
    4, 5, 6, 7,
    4, 5, 6, 7,
    4, 5, 6, 7,
    4, 5, 6, 7,
    4, 5, 6, 7,
    4, 5, 6, 7,
    4, 5, 6, 7,
    4, 5, 6, 7,
    4, 5, 6, 7,
    4, 5, 6, 7
], dtype=np.int32)

# Interleave pattern for long interleave (64 symbols)
LONG_INTLV_PATT = np.array([
    1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
    17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32,
    33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48,
    49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 0
], dtype=np.int32)

# Symbol shape (raised cosine window for MT63)
# This is the FFT window shape that minimizes inter-symbol interference
SYMBOL_SHAPE = np.array([
    -0.00000000, 0.00000665, 0.00002657, 0.00005975, 0.00010613, 0.00016562, 0.00023810, 0.00032341,
    0.00042134, 0.00053162, 0.00065389, 0.00078773, 0.00093261, 0.00108789, 0.00125283, 0.00142653,
    0.00160798, 0.00179599, 0.00198926, 0.00218628, 0.00238542, 0.00258487, 0.00278264, 0.00297662,
    0.00316452, 0.00334394, 0.00351232, 0.00366701, 0.00380526, 0.00392424, 0.00402109, 0.00409288,
    0.00413671, 0.00414969, 0.00412898, 0.00407182, 0.00397555, 0.00383764, 0.00365574, 0.00342767,
    0.00315145, 0.00282534, 0.00244787, 0.00201781, 0.00153424, 0.00099653, 0.00040435, -0.00024231,
    -0.00094314, -0.00169753, -0.00250453, -0.00336293, -0.00427118, -0.00522749, -0.00622977, -0.00727569,
    -0.00836272, -0.00948809, -0.01064886, -0.01184193, -0.01306405, -0.01431189, -0.01558198, -0.01687083,
    -0.01817486, -0.01949051, -0.02081416, -0.02214223, -0.02347113, -0.02479733, -0.02611728, -0.02742752,
    -0.02872457, -0.03000504, -0.03126551, -0.03250262, -0.03371298, -0.03489320, -0.03603988, -0.03714954,
    -0.03821868, -0.03924367, -0.04022079, -0.04114620, -0.04201589, -0.04282570, -0.04357126, -0.04424801,
    -0.04485118, -0.04537575, -0.04581648, -0.04616787, -0.04642421, -0.04657955, -0.04662769, -0.04656225,
    -0.04637665, -0.04606414, -0.04561786, -0.04503082, -0.04429599, -0.04340631, -0.04235475, -0.04113436,
    -0.03973834, -0.03816006, -0.03639316, -0.03443155, -0.03226956, -0.02990192, -0.02732385, -0.02453112,
    -0.02152012, -0.01828789, -0.01483216, -0.01115146, -0.00724508, -0.00311317, 0.00124328, 0.00582236,
    0.01062127, 0.01563627, 0.02086273, 0.02629504, 0.03192674, 0.03775043, 0.04375787, 0.04993995,
    0.05628681, 0.06278780, 0.06943159, 0.07620621, 0.08309914, 0.09009732, 0.09718730, 0.10435526,
    0.11158715, 0.11886870, 0.12618560, 0.13352351, 0.14086819, 0.14820561, 0.15552198, 0.16280389,
    0.17003841, 0.17721311, 0.18431620, 0.19133661, 0.19826401, 0.20508896, 0.21180289, 0.21839823,
    0.22486845, 0.23120806, 0.23741270, 0.24347919, 0.24940549, 0.25519079, 0.26083547, 0.26634116,
    0.27171067, 0.27694807, 0.28205857, 0.28704860, 0.29192571, 0.29669855, 0.30137684, 0.30597130,
    0.31049362, 0.31495636, 0.31937292, 0.32375741, 0.32812465, 0.33249001, 0.33686936, 0.34127898,
    0.34573545, 0.35025554, 0.35485613, 0.35955412, 0.36436627, 0.36930915, 0.37439902, 0.37965170,
    0.38508250, 0.39070609, 0.39653642, 0.40258662, 0.40886890, 0.41539446, 0.42217341, 0.42921470,
    0.43652603, 0.44411383, 0.45198311, 0.46013753, 0.46857925, 0.47730896, 0.48632585, 0.49562756,
    0.50521021, 0.51506840, 0.52519520, 0.53558220, 0.54621950, 0.55709582, 0.56819849, 0.57951351,
    0.59102568, 0.60271860, 0.61457478, 0.62657574, 0.63870210, 0.65093366, 0.66324951, 0.67562817,
    0.68804763, 0.70048553, 0.71291922, 0.72532590, 0.73768272, 0.74996688, 0.76215572, 0.77422687,
    0.78615828, 0.79792836, 0.80951602, 0.82090079, 0.83206287, 0.84298315, 0.85364335, 0.86402598,
    0.87411443, 0.88389296, 0.89334677, 0.90246195, 0.91122553, 0.91962547, 0.92765062, 0.93529073,
    0.94253642, 0.94937916, 0.95581122, 0.96182562, 0.96741616, 0.97257728, 0.97730410, 0.98159233,
    0.98543825, 0.98883864, 0.99179079, 0.99429241, 0.99634163, 0.99793696, 0.99907728, 0.99976178,
    0.99999000, 0.99976178, 0.99907728, 0.99793696, 0.99634163, 0.99429241, 0.99179079, 0.98883864,
    0.98543825, 0.98159233, 0.97730410, 0.97257728, 0.96741616, 0.96182562, 0.95581122, 0.94937916,
    0.94253642, 0.93529073, 0.92765062, 0.91962547, 0.91122553, 0.90246195, 0.89334677, 0.88389296,
    0.87411443, 0.86402598, 0.85364335, 0.84298315, 0.83206287, 0.82090079, 0.80951602, 0.79792836,
    0.78615828, 0.77422687, 0.76215572, 0.74996688, 0.73768272, 0.72532590, 0.71291922, 0.70048553,
    0.68804763, 0.67562817, 0.66324951, 0.65093366, 0.63870210, 0.62657574, 0.61457478, 0.60271860,
    0.59102568, 0.57951351, 0.56819849, 0.55709582, 0.54621950, 0.53558220, 0.52519520, 0.51506840,
    0.50521021, 0.49562756, 0.48632585, 0.47730896, 0.46857925, 0.46013753, 0.45198311, 0.44411383,
    0.43652603, 0.42921470, 0.42217341, 0.41539446, 0.40886890, 0.40258662, 0.39653642, 0.39070609,
    0.38508250, 0.37965170, 0.37439902, 0.36930915, 0.36436627, 0.35955412, 0.35485613, 0.35025554,
    0.34573545, 0.34127898, 0.33686936, 0.33249001, 0.32812465, 0.32375741, 0.31937292, 0.31495636,
    0.31049362, 0.30597130, 0.30137684, 0.29669855, 0.29192571, 0.28704860, 0.28205857, 0.27694807,
    0.27171067, 0.26634116, 0.26083547, 0.25519079, 0.24940549, 0.24347919, 0.23741270, 0.23120806,
    0.22486845, 0.21839823, 0.21180289, 0.20508896, 0.19826401, 0.19133661, 0.18431620, 0.17721311,
    0.17003841, 0.16280389, 0.15552198, 0.14820561, 0.14086819, 0.13352351, 0.12618560, 0.11886870,
    0.11158715, 0.10435526, 0.09718730, 0.09009732, 0.08309914, 0.07620621, 0.06943159, 0.06278780,
    0.05628681, 0.04993995, 0.04375787, 0.03775043, 0.03192674, 0.02629504, 0.02086273, 0.01563627,
    0.01062127, 0.00582236, 0.00124328, -0.00311317, -0.00724508, -0.01115146, -0.01483216, -0.01828789,
    -0.02152012, -0.02453112, -0.02732385, -0.02990192, -0.03226956, -0.03443155, -0.03639316, -0.03816006,
    -0.03973834, -0.04113436, -0.04235475, -0.04340631, -0.04429599, -0.04503082, -0.04561786, -0.04606414,
    -0.04637665, -0.04656225, -0.04662769, -0.04657955, -0.04642421, -0.04616787, -0.04581648, -0.04537575,
    -0.04485118, -0.04424801, -0.04357126, -0.04282570, -0.04201589, -0.04114620, -0.04022079, -0.03924367,
    -0.03821868, -0.03714954, -0.03603988, -0.03489320, -0.03371298, -0.03250262, -0.03126551, -0.03000504,
    -0.02872457, -0.02742752, -0.02611728, -0.02479733, -0.02347113, -0.02214223, -0.02081416, -0.01949051,
    -0.01817486, -0.01687083, -0.01558198, -0.01431189, -0.01306405, -0.01184193, -0.01064886, -0.00948809,
    -0.00836272, -0.00727569, -0.00622977, -0.00522749, -0.00427118, -0.00336293, -0.00250453, -0.00169753,
    -0.00094314, -0.00024231, 0.00040435, 0.00099653, 0.00153424, 0.00201781, 0.00244787, 0.00282534,
    0.00315145, 0.00342767, 0.00365574, 0.00383764, 0.00397555, 0.00407182, 0.00412898, 0.00414969,
    0.00413671, 0.00409288, 0.00402109, 0.00392424, 0.00380526, 0.00366701, 0.00351232, 0.00334394,
    0.00316452, 0.00297662, 0.00278264, 0.00258487, 0.00238542, 0.00218628, 0.00198926, 0.00179599,
    0.00160798, 0.00142653, 0.00125283, 0.00108789, 0.00093261, 0.00078773, 0.00065389, 0.00053162,
    0.00042134, 0.00032341, 0.00023810, 0.00016562, 0.00010613, 0.00005975, 0.00002657, 0.00000665
], dtype=np.float64)
